#+TITLE: User Guide for the ece-import Script
#+AUTHOR: Vizrt Online / The SaaS Team
#+OPTIONS: H:6 num:5 toc:2 

* Introduction
The =ece-import= script will help you with the following tasks:

- Setting up imports, either [[From an import archive]] or
[[  Without an import archive]]
- [[Getting raw import data from HTTP or FTP servers]]
- Running an import job, taking the raw XML from a 3rd party system,
  applying all defined transformations on it and dumping it in the
  designed import spool for Escenic Content Engine to pick it up and
  import it into its CMS. This is typically set up from a cron job,
  but [[Running an import job manually]] is easy with =ece-import=.

* Setting up a new import job

** From an import archive
The preferred way is to use an import archive, which you typically get
from the web site developers who've created the XSL files and so on.
#+BEGIN_SRC text
# ece-import --import-archive /tmp/import-archive.zip create
#+END_SRC

** Without an import archive
#+BEGIN_SRC text
# ece-import \
#   --name  streaming-video \
#   --publication mypub \
#   create
#+END_SRC

* Getting raw import data from HTTP or FTP servers
There's built-in support for this in =ece-import=:
#+BEGIN_SRC text
$ ece-import \
  --name streaming-video \
  --publication mypub \
  --user my-ftp-user \
  --password my-ftp-password \
  --uri http://news-feed.com/my-import-job-feed
  download-import-data
[ece-import-0] Started @ Mon Nov 5 09:30:39 UTC 2012, I'm logging to
[ece-import-0] /var/log/escenic/ece-import-root.log
[ece-import-1] 12.xml has already been downloaded, skipping to the next one
[ece-import-1] 19.xml has already been downloaded, skipping to the next one
[ece-import-1] Downloading http://news-feed.com/my-import-job-feed/20.xml ...
[ece-import-1] Downloading http://news-feed.com/my-import-job-feed/21.xml ...
[ece-import-2] Downloading http://news-feed.com/my-import-job-feed/22.xml ...
[ece-import-3] Downloading http://news-feed.com/my-import-job-feed/23.xml ...
[ece-import-3] Downloading http://news-feed.com/my-import-job-feed/24.xml ...
[ece-import-4] Downloading http://news-feed.com/my-import-job-feed/25.xml ...
[ece-import-5] Downloading http://news-feed.com/my-import-job-feed/26.xml ...
[ece-import-6] Finished @ Mon Nov 5 09:30:45 UTC 2012
#+END_SRC

You can safely re-run this as many times as you wish, =ece-import=
will keep track of previously downloaded files. If you ever need to
re-download third party data, you can remove the corresponding
resource from =/var/lib/escenic/raw/mypub/streaming-video/download.state=

* Running an import job manually
#+BEGIN_SRC text
$ ece-import \
  --name streaming-video \
  --publication mypub
[ece-import-0] Started @ Mon Nov 5 09:36:33 UTC 2012, I'm logging to
[ece-import-0] /var/log/escenic/ece-import-root.log
[ece-import-0] Publication: mypub
[ece-import-0] Import configuration: streaming-video
[ece-import-0] Importing raw XML #1: 21.xml ...
[ece-import-0] Importing raw XML #2: 26.xml ...
[ece-import-1] Importing raw XML #3: 24.xml ...
[ece-import-4] Number of raw XML files proccessed: 3
[ece-import-4] Number of raw XML successes: 3
[ece-import-4] Number of raw XML errors: 0
[ece-import-4] Finished @ Mon Nov 5 09:36:37 UTC 2012, enjoy thyself!
#+END_SRC

